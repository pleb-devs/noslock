/**
 * NIP-19 Security Utilities
 *
 * This module provides security enhancements for NIP-19 decoded entities
 * to prevent attacks like XSS through invalid relay URLs.
 */
import { ProfileData, EventData, AddressData, RelayUrl } from "./types";
/**
 * Validates if a relay URL is safe to use
 * - Must start with wss:// or ws://
 * - Must be a valid URL
 * - No credentials (username/password) in URL
 * - No URL confusion or redirection tricks
 * - Valid port numbers (1-65535, not 0)
 * - No null bytes or dangerous characters in hostname
 * - No null bytes in query parameters
 */
export declare function isValidRelayUrl(url: RelayUrl): boolean;
/**
 * Filter invalid relay URLs from a decoded profile
 * Use this after decoding with decodeProfile() for enhanced security
 */
export declare function filterProfile(profile: ProfileData): ProfileData;
/**
 * Filter invalid relay URLs from a decoded event
 * Use this after decoding with decodeEvent() for enhanced security
 */
export declare function filterEvent(event: EventData): EventData;
/**
 * Filter invalid relay URLs from a decoded address
 * Use this after decoding with decodeAddress() for enhanced security
 */
export declare function filterAddress(address: AddressData): AddressData;
/**
 * Safely decode any NIP-19 entity that contains relay URLs
 * Returns the filtered result with only valid relay URLs
 *
 * @param entity The decoded entity (from decodeProfile, decodeEvent, decodeAddress)
 * @returns A filtered entity with only valid relay URLs
 */
export declare function filterEntity<T extends ProfileData | EventData | AddressData>(entity: T): T;
