import { NIP46Request } from "../types";
import { Logger } from "./logger";
/**
 * Enhanced validation utilities for NIP-46 security
 */
export declare const MAX_CONTENT_SIZE = 65536;
export declare const MAX_ID_LENGTH = 64;
export declare const MAX_PARAMS_COUNT = 10;
export declare const MAX_PARAM_LENGTH = 32768;
export declare const MAX_TAGS_COUNT = 100;
export declare const MAX_TAG_ELEMENT_LENGTH = 2048;
/**
 * Validate event content size and structure
 */
export declare function validateEventContent(content: string): boolean;
/**
 * Validate public key format (strict hex validation)
 */
export declare function validatePubkey(pubkey: string): boolean;
/**
 * Validate event ID format
 */
export declare function validateEventId(eventId: string): boolean;
/**
 * Validate signature format
 */
export declare function validateSignature(signature: string): boolean;
/**
 * Validate private key format (for internal use)
 */
export declare function validatePrivateKey(privateKey: string): boolean;
/**
 * Validate complete NIP-46 request payload
 */
export declare function validateRequestPayload(request: NIP46Request): boolean;
/**
 * Validate NIP-46 method
 */
export declare function isValidMethod(method: string): boolean;
/**
 * Validate request parameters
 */
export declare function validateParams(params: string[]): boolean;
/**
 * Validate relay URL format
 */
export declare function validateRelayUrl(url: string): boolean;
/**
 * Validate permission string format
 */
export declare function validatePermission(permission: string): boolean;
/**
 * Validate connection string format
 */
export declare function validateConnectionString(connectionString: string): boolean;
/**
 * Validate JSON string and return parsing result
 */
export declare function validateAndParseJson(jsonString: string): {
    valid: boolean;
    data?: unknown;
    error?: string;
};
/**
 * Sanitize string input to prevent injection attacks
 */
export declare function sanitizeString(input: string, maxLength?: number): string;
/**
 * Validate timestamp for replay attack prevention
 */
export declare function validateTimestamp(timestamp: number, maxAgeSeconds?: number): boolean;
/**
 * Secure error handler to prevent information disclosure
 */
export declare class SecureErrorHandler {
    private static securityLogger;
    private static securityLoggingEnabled;
    /**
     * Initialize security logging with a custom logger
     */
    static initializeSecurityLogging(logger?: Logger, enabled?: boolean): void;
    /**
     * Enable or disable security event logging
     */
    static setSecurityLoggingEnabled(enabled: boolean): void;
    /**
     * Check if security logging is enabled
     */
    static isSecurityLoggingEnabled(): boolean;
    /**
     * Sanitize error messages for safe client communication
     */
    static sanitizeError(error: Error, isDebug?: boolean): string;
    /**
     * Log security events without exposing sensitive data
     */
    static logSecurityEvent(event: string, details: Record<string, unknown>, sensitive?: string[]): void;
}
