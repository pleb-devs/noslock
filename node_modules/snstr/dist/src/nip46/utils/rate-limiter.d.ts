/**
 * Rate limiting system for NIP-46 to prevent DoS attacks
 */
export interface RateLimitConfig {
    maxRequestsPerMinute?: number;
    maxRequestsPerHour?: number;
    burstSize?: number;
    cleanupIntervalMs?: number;
}
export interface RateLimitResult {
    allowed: boolean;
    retryAfter?: number;
    remainingRequests?: number;
}
export declare class NIP46RateLimiter {
    private readonly maxRequestsPerMinute;
    private readonly maxRequestsPerHour;
    private readonly burstSize;
    private readonly cleanupIntervalMs;
    private clientHistory;
    private cleanupInterval;
    constructor(config?: RateLimitConfig);
    /**
     * Check if a request is allowed for the given client
     */
    isAllowed(clientPubkey: string): RateLimitResult;
    /**
     * Get remaining requests for a client (for informational purposes)
     */
    getRemainingRequests(clientPubkey: string): {
        minute: number;
        hour: number;
        burst: number;
    };
    /**
     * Clear rate limiting history for a client (for testing or admin purposes)
     */
    clearClient(clientPubkey: string): void;
    /**
     * Clear all rate limiting history
     */
    clearAll(): void;
    /**
     * Get or create history for a client
     */
    private getOrCreateHistory;
    /**
     * Clean old requests from history
     */
    private cleanHistory;
    /**
     * Start cleanup interval to prevent memory leaks
     */
    private startCleanup;
    /**
     * Perform periodic cleanup of old data
     */
    private performCleanup;
    /**
     * Stop the rate limiter and clean up resources
     */
    destroy(): void;
    /**
     * Get statistics about current rate limiting state
     */
    getStats(): {
        totalClients: number;
        totalRequests: number;
        oldestRequest: number | null;
        newestRequest: number | null;
    };
}
