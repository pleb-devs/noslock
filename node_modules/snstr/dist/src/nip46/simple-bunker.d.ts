import { SimpleNIP46BunkerOptions } from "./types";
import { LogLevel } from "./utils/logger";
/**
 * Simple implementation of a NIP-46 bunker (remote signer)
 *
 * This class implements the signer-side of the NIP-46 Remote Signing protocol.
 * It is designed to be lightweight and easy to use.
 */
export declare class SimpleNIP46Bunker {
    private nostr;
    private relays;
    private userKeys;
    private signerKeys;
    private clients;
    private defaultPermissions;
    private subId;
    private secret?;
    private logger;
    private debug;
    /**
     * Create a new SimpleNIP46Bunker
     *
     * @param relays - Array of relay URLs to connect to
     * @param userPubkey - The user's public key
     * @param signerPubkey - Optional separate signer public key (defaults to user pubkey)
     * @param options - Bunker options
     */
    constructor(relays: string[], userPubkey: string, signerPubkey?: string, options?: SimpleNIP46BunkerOptions);
    /**
     * Start the bunker and listen for requests
     */
    start(): Promise<void>;
    /**
     * Stop the bunker
     */
    stop(): Promise<void>;
    /**
     * Get a connection string for clients
     */
    getConnectionString(): string;
    /**
     * Set the user's private key
     */
    setUserPrivateKey(privateKey: string): void;
    /**
     * Set the signer's private key
     */
    setSignerPrivateKey(privateKey: string): void;
    /**
     * Set default permissions for all clients
     */
    setDefaultPermissions(permissions: string[]): void;
    /**
     * Add a permission for a specific client
     */
    addClientPermission(clientPubkey: string, permission: string): boolean;
    /**
     * Remove a permission from a specific client
     */
    removeClientPermission(clientPubkey: string, permission: string): boolean;
    /**
     * Handle an incoming request event
     */
    private handleRequest;
    /**
     * Handle a connect request
     */
    private handleConnect;
    /**
     * Handle a sign_event request
     */
    private handleSignEvent;
    /**
     * Handle NIP-44 encryption request (preferred)
     */
    private handleNIP44Encrypt;
    /**
     * Handle NIP-44 decryption request (preferred)
     */
    private handleNIP44Decrypt;
    /**
     * Handle NIP-04 encryption request (legacy support)
     */
    private handleNIP04Encrypt;
    /**
     * Handle NIP-04 decryption request (legacy support)
     */
    private handleNIP04Decrypt;
    /**
     * Handle get_relays request
     */
    private handleGetRelays;
    /**
     * Handle disconnect request
     */
    private handleDisconnect;
    /**
     * Send a response to a client
     */
    private sendResponse;
    /**
     * Check if a client is authorized
     */
    private isClientAuthorized;
    /**
     * Set the log level
     */
    setLogLevel(level: LogLevel): void;
}
