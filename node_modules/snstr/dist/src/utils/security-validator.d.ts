/**
 * Centralized Security Validation Utilities
 *
 * This module provides comprehensive security validation for the SNSTR library,
 * addressing the critical vulnerabilities identified in the security audit.
 */
import { NostrEvent, Filter } from "../types/nostr";
export declare const SECURITY_LIMITS: {
    readonly MAX_CONTENT_SIZE: 100000;
    readonly MAX_TAG_SIZE: 1000;
    readonly MAX_TAG_COUNT: 100;
    readonly MAX_TAG_ELEMENT_SIZE: 512;
    readonly MAX_FILTER_COUNT: 20;
    readonly MAX_FILTER_IDS: 1000;
    readonly MAX_FILTER_AUTHORS: 1000;
    readonly MAX_FILTER_KINDS: 100;
    readonly MAX_FILTER_TAG_VALUES: 1000;
    readonly MAX_SEARCH_LENGTH: 500;
    readonly MAX_ARRAY_SIZE: 10000;
    readonly MAX_OBJECT_DEPTH: 10;
    readonly MAX_STRING_LENGTH: 100000;
    readonly MAX_URL_LENGTH: 2048;
    readonly MAX_PUBKEY_LENGTH: 64;
    readonly MAX_SIGNATURE_LENGTH: 128;
    readonly MAX_ID_LENGTH: 64;
    readonly MIN_KIND: 0;
    readonly MAX_KIND: 65535;
    readonly MIN_CREATED_AT: 946684800;
    readonly MAX_CREATED_AT: 4102444800;
    readonly MIN_LIMIT: 0;
    readonly MAX_LIMIT: 5000;
    readonly MIN_SINCE: 946684800;
    readonly MAX_SINCE: 4102444800;
    readonly MIN_UNTIL: 946684800;
    readonly MAX_UNTIL: 4102444800;
    readonly MAX_RELAY_EVENT_BUFFERS: 1000;
    readonly MAX_EVENTS_PER_BUFFER: 100;
    readonly MAX_REPLACEABLE_EVENT_PUBKEYS: 10000;
    readonly MAX_REPLACEABLE_EVENTS_PER_PUBKEY: 50;
    readonly MAX_ADDRESSABLE_EVENTS: 50000;
};
export declare class SecurityValidationError extends Error {
    code: string;
    field?: string | undefined;
    constructor(message: string, code: string, field?: string | undefined);
}
export declare function secureRandomBytes(length: number): Uint8Array;
/**
 * Generate a secure random hex string
 * Used for subscription IDs, nonces, and other cryptographic identifiers
 * @param length Number of hex characters to generate (not bytes)
 * @returns A secure random hex string of the specified length
 * @throws SecurityValidationError if secure random generation is not available
 *
 * @example
 * secureRandomHex(16) // Returns 16-character hex string (8 bytes)
 * secureRandomHex(64) // Returns 64-character hex string (32 bytes)
 */
export declare function secureRandomHex(length: number): string;
/**
 * Generate a secure random number between 0 and 1
 * Used for jitter generation and other timing operations
 * @returns A secure random float between 0 (inclusive) and 1 (exclusive)
 * @throws SecurityValidationError if secure random generation is not available
 */
export declare function getSecureRandom(): number;
export declare function sanitizeString(input: unknown, maxLength?: number): string;
export declare function validateArrayAccess<T>(array: T[], index: number, context?: string): T;
export declare function safeArrayAccess<T>(array: T[], index: number, defaultValue?: T): T | undefined;
export declare function validateNumber(value: unknown, min: number, max: number, field: string): number;
export declare function validateEventContent(content: unknown): string;
export declare function validateTags(tags: unknown): string[][];
export declare function validateFilter(filter: unknown): Filter;
export declare function validateFilters(filters: unknown): Filter[];
export declare function validateEvent(event: unknown): NostrEvent;
export interface RateLimitState {
    count: number;
    windowStart: number;
    blocked: boolean;
}
export declare function checkRateLimit(state: RateLimitState, limit: number, windowMs: number, now?: number): {
    allowed: boolean;
    retryAfter?: number;
};
export declare function secureStringZero(str: string): void;
export declare function secureBufferZero(buffer: Uint8Array): void;
export declare function secureKeyCleanup(privateKey: string): void;
export declare function validatePrivateKey(privateKey: unknown, field?: string): string;
export declare function enforceMemoryLimits<K, V>(map: Map<K, V>, maxSize: number, accessTracker?: Map<K, number>, context?: string): void;
